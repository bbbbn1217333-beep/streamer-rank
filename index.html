<script>
const SHEET_ID = "18F2mJsiSWYbxSl97u4vKEX9pTuEOuoL1WaGE5PB_iJ0";
const SHEET_NAME = "ì‹œíŠ¸1";
const RANGE = "E11:I15";
const board = document.getElementById("board");
let prevData = "";

// ë Œë”ë§ í•¨ìˆ˜
function render(data) {
  if(!data || !data.length){ board.innerHTML="ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤ ğŸ˜¶"; return; }

  // ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
  data.sort((a,b)=> Number(b["ğŸ“ìµœì¢… ì ìˆ˜"]) - Number(a["ğŸ“ìµœì¢… ì ìˆ˜"]));

  // ìˆœìœ„ ê³„ì‚° (ë™ì  ì²˜ë¦¬)
  let rank = 1;
  let lastScore = null;
  let sameRankCount = 0;
  data.forEach((row, i)=>{
    const score = Number(row["ğŸ“ìµœì¢… ì ìˆ˜"]);
    if(score === lastScore){
      row.rank = rank;
      sameRankCount++;
    } else {
      rank += sameRankCount;
      row.rank = rank;
      lastScore = score;
      sameRankCount = 1;
    }
  });

  const json = JSON.stringify(data);
  if(json === prevData) return;
  prevData = json;

  board.innerHTML = "";

  // í—¤ë”
  const header = document.createElement("div");
  header.className = "row header";
  header.innerHTML = `
    <div class="rank">ìˆœìœ„</div>
    <div>ğŸ™ï¸ ìŠ¤íŠ¸ë¦¬ë¨¸</div>
    <div class="num">ğŸ¥Š1ì„¸íŠ¸</div>
    <div class="num">ğŸ¥Š2ì„¸íŠ¸</div>
    <div class="num">ğŸ¥Š3ì„¸íŠ¸</div>
    <div class="score">ğŸ“ìµœì¢… ì ìˆ˜</div>
  `;
  board.appendChild(header);

  // ë°ì´í„° í–‰
  data.forEach((row, i)=>{
    const div = document.createElement("div");
    div.className = "row";

    if(i===0) div.classList.add("gold");
    if(i===1) div.classList.add("silver");
    if(i===2) div.classList.add("bronze");

    const medal = row.rank===1?"ğŸ‘‘":row.rank===2?"ğŸ¥ˆ":row.rank===3?"ğŸ¥‰":row.rank;

    div.innerHTML = `
      <div class="rank ${row.rank===1?"crown":""}">${medal}</div>
      <div class="name">${row["ğŸ™ï¸ìŠ¤íŠ¸ë¦¬ë¨¸"]}</div>
      <div class="num">${row["ğŸ¥Š1ì„¸íŠ¸"]}</div>
      <div class="num">${row["ğŸ¥Š2ì„¸íŠ¸"]}</div>
      <div class="num">${row["ğŸ¥Š3ì„¸íŠ¸"]}</div>
      <div class="score">${row["ğŸ“ìµœì¢… ì ìˆ˜"]}</div>
    `;
    board.appendChild(div);
  });
}

// ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
async function fetchData() {
  const URL = `https://opensheet.elk.sh/${SHEET_ID}/${encodeURIComponent(SHEET_NAME)}!${RANGE}?t=${Date.now()}`;
  try{
    const res = await fetch(URL);
    const data = await res.json();
    render(data);
  }catch(e){
    console.error("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:", e);
    board.innerHTML = "ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨ ğŸ˜¢";
  }
}

// ê°±ì‹  ì£¼ê¸° 5ì´ˆ
fetchData();
setInterval(fetchData, 5000);
</script>


















